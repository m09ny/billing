<div class="container">
  <p-steps [model]="stepItems" [(activeIndex)]="activeIndex" [readonly]="false"></p-steps>
</div>
<form [formGroup]="addOrderForm" (ngSubmit)="onSubmitAddOrderForm()">
  <div *ngIf="activeIndex === 0">
    <div class="container">
      <p-pickList [source]="materials" [target]="selectedMaterials" (onMoveToTarget)="onMoveToTarget($event)" filterBy="fullName" [showTargetFilter]="false" sourceHeader="Materiale" targetHeader="Materialul ales" [responsive]="true" dragdrop="true" [showSourceControls]="false" [showTargetControls]="false" sourceFilterPlaceholder="Cauta dupa nume">
        <ng-template let-material pTemplate="item">
          <div style="font-size: 16px"><b>{{material.fullName}}</b></div>
          <div>
            <div><span>Pret fara T.V.A.</span><span style="float: right">{{material.price}} RON</span></div>
            <div><span>Pret cu T.V.A.</span><span style="float: right">{{material.priceVat}} RON</span></div>
          </div>
        </ng-template>
        <ng-template let-material pTemplate="emptymessagetarget">
          <div style="opacity: 0.5">Cosul este gol.</div>
        </ng-template>
      </p-pickList>
    </div>
  </div>
  <div *ngIf="activeIndex === 1">
    <p-table id="newEntriesTable" [value]="addOrderForm.controls['entries'].controls">
      <ng-template pTemplate="caption">
        <div>
          <p-button type="button" label="Intrare noua" icon="pi pi-plus" iconPos="left" (onClick)="onAddEntry()"></p-button>
        </div>
      </ng-template>
      <ng-template pTemplate="header">
        <tr>
          <th rowspan="2" style="width:50px">Nr. Crt.</th>
          <th colspan="2">Dimensiuni (cm)</th>
          <th colspan="4">Profilare</th>
          <th colspan="4">Picurator</th>
          <th rowspan="2">Nr. bucati</th>
          <th rowspan="2">Taiere (ML)</th>
          <th rowspan="2">Profilare</th>
          <th rowspan="2">Picurator</th>
          <th rowspan="2">Suprafata (m<sup>2</sup>)</th>
          <th rowspan="2" style="width:30px"></th>
        </tr>
        <tr>
            <th colspan="1">Lungime</th>
            <th colspan="1">Latime</th>
            <th colspan="1">L1</th>
            <th colspan="1">L2</th>
            <th colspan="1">Istg</th>
            <th colspan="1">Idr</th>
            <th colspan="1">L1</th>
            <th colspan="1">L2</th>
            <th colspan="1">Istg</th>
            <th colspan="1">Idr</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-entry let-i="rowIndex">
        <tr formArrayName="entries">
          <td>{{i}}</td>
          <td [formGroupName]="i"><span formGroupName="dimension"><input pInputText type="number" formControlName="length"></span></td>
          <td [formGroupName]="i"><span formGroupName="dimension"><input pInputText type="number" formControlName="width"></span></td>
          <td [formGroupName]="i"><span formGroupName="profiling"><input pInputText type="number" formControlName="l1"></span></td>
          <td [formGroupName]="i"><span formGroupName="profiling"><input pInputText type="number" formControlName="l2"></span></td>
          <td [formGroupName]="i"><span formGroupName="profiling"><input pInputText type="number" formControlName="istg"></span></td>
          <td [formGroupName]="i"><span formGroupName="profiling"><input pInputText type="number" formControlName="idr"></span></td>
          <td [formGroupName]="i"><span formGroupName="drainer"><input pInputText type="number" formControlName="l1"></span></td>
          <td [formGroupName]="i"><span formGroupName="drainer"><input pInputText type="number" formControlName="l2"></span></td>
          <td [formGroupName]="i"><span formGroupName="drainer"><input pInputText type="number" formControlName="istg"></span></td>
          <td [formGroupName]="i"><span formGroupName="drainer"><input pInputText type="number" formControlName="idr"></span></td>
          <td [formGroupName]="i"><span><input pInputText type="number" formControlName="piecesNumber"></span></td>
          <td [formGroupName]="i"><span><input pInputText type="number" formControlName="cutting"></span></td>
          <td [formGroupName]="i"><span><input pInputText type="number" formControlName="profilingSum"></span></td>
          <td [formGroupName]="i"><span><input pInputText type="number" formControlName="drainerSum"></span></td>
          <td [formGroupName]="i"><span><input pInputText type="number" formControlName="area"></span></td>
          <td><p-button type="button" icon="pi pi-trash" styleClass="ui-button-danger" (click)="onDeleteEntry(i)"></p-button></td>
        </tr>
      </ng-template>
      <ng-template pTemplate="footer">
        <tr>
            <td colspan="11" style="text-align: start"><span style="margin-left: 10px">Total</span></td>
            <td formGroupName="entriesTotal"><span><input pInputText type="number" formControlName="totalPiecesNumber"></span></td>
            <td formGroupName="entriesTotal"><span><input pInputText type="number" formControlName="totalCuttings"></span></td>
            <td formGroupName="entriesTotal"><span><input pInputText type="number" formControlName="totalProfiling"></span></td>
            <td formGroupName="entriesTotal"><span><input pInputText type="number" formControlName="totalDraining"></span></td>
            <td formGroupName="entriesTotal"><span><input pInputText type="number" formControlName="totalArea"></span></td>
        </tr>
      </ng-template>
      <ng-template pTemplate="summary">
        Summary
      </ng-template>
    </p-table>
  </div>
  <div *ngIf="activeIndex === 2">
    <div class="container">
      <div class="p-grid">
        <div class="p-col-3">
          Decupaje lavoare(bucati)
        </div>
        <div class="p-col-9">
          <input pInputText type="number" [formControl]="addOrderForm.controls['workmanship'].controls['decupajeLavoare']">
        </div>
        <div class="p-col-3">
          Decupaje pe curb(ML)
        </div>
        <div class="p-col-9">
          <input pInputText type="number" [formControl]="addOrderForm.controls['workmanship'].controls['decupajePeCurb']">
        </div>
        <div class="p-col-3">
          Gauri carota(bucati)
        </div>
        <div class="p-col-9">
          <input pInputText type="number" [formControl]="addOrderForm.controls['workmanship'].controls['gauriCarota']">
        </div>
        <div class="p-col-3">
          Lipire adaos(ML)
        </div>
        <div class="p-col-9">
          <input pInputText type="number" [formControl]="addOrderForm.controls['workmanship'].controls['lipireAdaos']">
        </div>
        <div class="p-col-3">
          Canal antiderapant(ML)
        </div>
        <div class="p-col-9">
          <input pInputText type="number" [formControl]="addOrderForm.controls['workmanship'].controls['canalAntiderapant']">
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="activeIndex === 3">
    <div class="container">
      <div class="p-grid">
        <div class="p-col-2">
          Societatea:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['society']" size="60" placeholder="Pietricica lucioasa SRL">
        </div>
        <div class="p-col-2">
          Localitate Sediu:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['city']" size="60" placeholder="Baicoi">
        </div>
        <div class="p-col-2">
          Str:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['street']" size="60" placeholder="Debitarii">
        </div>
        <div class="p-col-2">
          Nr:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['streetNumber']" size="60" placeholder="12345">
        </div>
        <div class="p-col-2">
          Tel:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['tel']" size="60" maxlength="10" placeholder="0748567895">
        </div>
        <div class="p-col-2">
          CF RO:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['cfRo']" size="60" placeholder="1234567">
        </div>
        <div class="p-col-2">
          RC:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['rc']" size="60" placeholder="J08/1224/1997">
        </div>
        <div class="p-col-2">
          Cont nr.:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['account'].controls['first']" size="7" maxlength="4" placeholder="RO22">
          <span style="margin: 4px">-</span>
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['account'].controls['second']" size="7" maxlength="4" placeholder="BTRL">
          <span style="margin: 4px">-</span>
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['account'].controls['third']" size="7" maxlength="4" placeholder="0012">
          <span style="margin: 4px">-</span>
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['account'].controls['fourth']" size="7" maxlength="4" placeholder="3456">
          <span style="margin: 4px">-</span>
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['account'].controls['fifth']" size="7" maxlength="4" placeholder="3456">
        </div>
        <div class="p-col-2">
          Cont deschis la:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['bank']" size="60" placeholder="BCR">
        </div>
        <div class="p-col-2">
          Reprezentat de:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['owner']" size="60" placeholder="Gigi Marmoratu'">
        </div>
        <div class="p-col-2">
          In calitate de:*
        </div>
        <div class="p-col-10">
          <input pInputText type="text" [formControl]="addOrderForm.controls['clientMetadata'].controls['ownerStatus']" size="60" placeholder="Sef de trib">
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="activeIndex === 4">
    <div class="container">
      <div class="p-grid">
        <div class="p-col-10">
          <div class="p-grid">
            <div class="p-col-4" style="text-align: end">Societatea:</div>
            <div class="p-col-8"><b>{{addOrderForm.value.clientMetadata.society}}</b></div>
            <div class="p-col-4" style="text-align: end">Adresa:</div>
            <div class="p-col-8">
              <span><b>{{addOrderForm.value.clientMetadata.city}}</b>, </span>
              <span>str. <b>{{addOrderForm.value.clientMetadata.street}}</b>, </span>
              <span>nr. <b>{{addOrderForm.value.clientMetadata.streetNumber}}</b></span>
            </div>
            <div class="p-col-4" style="text-align: end">Tel:</div>
            <div class="p-col-8"><b>{{addOrderForm.value.clientMetadata.tel}}</b></div>
            <div class="p-col-4" style="text-align: end">CF RO:</div>
            <div class="p-col-8"><b>{{addOrderForm.value.clientMetadata.cfRo}}</b></div>
            <div class="p-col-4" style="text-align: end">RC:</div>
            <div class="p-col-8"><b>{{addOrderForm.value.clientMetadata.rc}}</b></div>
            <div class="p-col-4" style="text-align: end">Cont bancar:</div>
            <div class="p-col-8">
                <b>
                  <span style="margin-right: 5px">{{addOrderForm.value.clientMetadata.account.first}}</span>
                  <span style="margin-right: 5px">{{addOrderForm.value.clientMetadata.account.second}}</span>
                  <span style="margin-right: 5px">{{addOrderForm.value.clientMetadata.account.third}}</span>
                  <span style="margin-right: 5px">{{addOrderForm.value.clientMetadata.account.fourth}}</span>
                  <span>{{addOrderForm.value.clientMetadata.account.fifth}}</span>
                </b>
                <span>, deschis la <b>{{addOrderForm.value.clientMetadata.bank}}</b></span>
            </div>
            <div class="p-col-4" style="text-align: end">Reprezentat de:</div>
            <div class="p-col-8">
              <span><b>{{addOrderForm.value.clientMetadata.owner}}</b></span>
              <span> in calitate de <b>{{addOrderForm.value.clientMetadata.ownerStatus}}</b></span>
            </div>
          </div>
        </div>
        <div class="p-col-2">
          <p-button label="Finalizare comanda" type="submit" icon="pi pi-angle-double-right"></p-button>
        </div>
        <div class="p-col-12">
          <div class="container" style="padding-top: 40px">
            <table id="order-summary-table" class="table table-striped table-sm table-bordered">
              <thead>
                <tr class="thead-dark">
                  <th colspan="2">Material</th>
                  <th colspan="5">{{addOrderForm.value.material.fullName}}</th>
                </tr>
                <tr class="table-secondary">
                  <th colspan="1" rowspan="2"></th>
                  <th colspan="1" rowspan="2"></th>
                  <th colspan="1">Taiere (m<sup>2</sup>)</th>
                  <th colspan="1">Profilare</th>
                  <th colspan="1">Picurator</th>
                  <th colspan="2">Numar de bucati total</th>
                </tr>
                <tr>
                  <td colspan="1">{{addOrderForm.controls['entriesTotal'].controls['totalArea'].value}}</td>
                  <td colspan="1">{{addOrderForm.controls['entriesTotal'].controls['totalProfiling'].value}}</td>
                  <td colspan="1">{{addOrderForm.controls['entriesTotal'].controls['totalDraining'].value}}</td>
                  <td colspan="2">{{addOrderForm.controls['entriesTotal'].controls['totalPiecesNumber'].value}}</td>
                </tr>
                <tr class="table-secondary">
                  <th colspan="1">#</th>
                  <th colspan="2">Lungime (cm)</th>
                  <th colspan="2">Latime (cm)</th>
                  <th colspan="2">Numar de bucati</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let entry of addOrderForm.value.entries; index as i">
                  <th colspan="1">{{i + 1}}</th>
                  <td colspan="2">{{entry.dimension.length}}</td>
                  <td colspan="2">{{entry.dimension.width}}</td>
                  <td colspan="2">{{entry.piecesNumber}}</td>
                </tr>
              </tbody>
              <tfoot>
                <tr class="thead-dark">
                  <th colspan="7"></th>
                </tr>
                <tr class="table-secondary">
                  <th colspan="1" rowspan="6"></th>
                  <th colspan="1" rowspan="2"></th>
                  <th colspan="1">Decupaje lavoare</th>
                  <th colspan="1">Decupaje pe curb</th>
                  <th colspan="1">Gauri carota</th>
                  <th colspan="1">Lipire adaos</th>
                  <th colspan="1">Canal antiderapant</th>
                </tr>
                <tr>
                  <td colspan="1">{{addOrderForm.value.workmanship.decupajeLavoare}} bucati</td>
                  <td colspan="1">{{addOrderForm.value.workmanship.decupajePeCurb}} ML</td>
                  <td colspan="1">{{addOrderForm.value.workmanship.gauriCarota}} bucati</td>
                  <td colspan="1">{{addOrderForm.value.workmanship.lipireAdaos}} ML</td>
                  <td colspan="1">{{addOrderForm.value.workmanship.canalAntiderapant}} ML</td>
                </tr>
                <tr class="table-secondary">
                  <th colspan="3">Semibaston</th>
                  <th colspan="3">Bizot</th>
                </tr>
                <tr>
                  <th colspan="2">Manopera finisaj</th>
                  <td colspan="1">{{addOrderForm.value.semibastonWorkmanshipPrice}} lei</td>
                  <th colspan="2">Manopera finisaj</th>
                  <td colspan="1">{{addOrderForm.value.bizotWorkmanshipPrice}} lei</td>
                </tr>
                <tr>
                  <th colspan="2">Semibaston total general fara TVA</th>
                  <td colspan="1">{{addOrderForm.value.semibastonTotalPrice}} lei</td>
                  <th colspan="2">Bizot total general fara TVA</th>
                  <td colspan="1">{{addOrderForm.value.bizotTotalPrice}} lei</td>
                </tr>
                <tr>
                  <th colspan="2">Semibaston total general cu TVA</th>
                  <td colspan="1">{{addOrderForm.value.semibastonTotalPriceVat}} lei</td>
                  <th colspan="2">Bizot total general cu TVA</th>
                  <td colspan="1">{{addOrderForm.value.bizotTotalPriceVat}} lei</td>
                </tr>
                <tr class="thead-dark">
                  <th colspan="7" style="text-align: end">Total Material: {{addOrderForm.value.materialTotalPrice}} lei</th>
                </tr>
                <tr class="thead-dark">
                  <th colspan="7" style="text-align: end">Total: {{addOrderForm.value.totalPrice}} lei</th>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>